Wed May  1 12:55:56 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.54.15              Driver Version: 550.54.15      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100 80GB PCIe          On  |   00000000:CA:00.0 Off |                    0 |
| N/A   24C    P0             40W /  300W |       0MiB /  81920MiB |      0%   E. Process |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
[Warning] Fused window process have not been installed. Please refer to get_started.md for installation.
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
├─Conv2d: 1-1                                 [-1, 31, 128, 128]        1,674
├─ModuleList: 1                               []                        --
|    └─ModuleList: 2                          []                        --
|    |    └─DTNBlock: 3-1                     [-1, 31, 128, 128]        129,752
|    |    └─DownSample: 3-2                   [-1, 62, 64, 64]          30,876
|    └─ModuleList: 2                          []                        --
|    |    └─DTNBlock: 3-3                     [-1, 62, 64, 64]          472,112
|    |    └─DownSample: 3-4                   [-1, 124, 32, 32]         123,256
|    └─ModuleList: 2                          []                        --
|    |    └─DTNBlock: 3-5                     [-1, 124, 32, 32]         1,813,040
|    |    └─DownSample: 3-6                   [-1, 248, 16, 16]         492,528
|    └─ModuleList: 2                          []                        --
|    |    └─DTNBlock: 3-7                     [-1, 248, 16, 16]         7,119,728
|    |    └─DownSample: 3-8                   [-1, 496, 8, 8]           1,969,120
├─DTNBlock: 1-2                               [-1, 496, 8, 8]           --
|    └─Sequential: 2-1                        [-1, 496, 8, 8]           --
|    |    └─Adaptive_MSAB: 3-9                [-1, 496, 8, 8]           7,069,211
|    |    └─Adaptive_SWTB: 3-10               [-1, 496, 8, 8]           7,044,027
|    |    └─Adaptive_MSAB: 3-11               [-1, 496, 8, 8]           7,069,211
|    |    └─Adaptive_SWTB: 3-12               [-1, 496, 8, 8]           7,044,027
|    |    └─Adaptive_MSAB: 3-13               [-1, 496, 8, 8]           7,069,211
|    |    └─Adaptive_SWTB: 3-14               [-1, 496, 8, 8]           7,044,027
|    |    └─Adaptive_MSAB: 3-15               [-1, 496, 8, 8]           7,069,211
|    |    └─Adaptive_SWTB: 3-16               [-1, 496, 8, 8]           7,044,027
├─ModuleList: 1                               []                        --
|    └─ModuleList: 2                          []                        --
|    |    └─UpSample: 3-17                    [-1, 248, 16, 16]         2,091,136
|    |    └─Conv2d: 3-18                      [-1, 248, 16, 16]         123,008
|    |    └─DTNBlock: 3-19                    [-1, 248, 16, 16]         7,119,728
|    └─ModuleList: 2                          []                        --
|    |    └─UpSample: 3-20                    [-1, 124, 32, 32]         522,784
|    |    └─Conv2d: 3-21                      [-1, 124, 32, 32]         30,752
|    |    └─DTNBlock: 3-22                    [-1, 124, 32, 32]         1,813,040
|    └─ModuleList: 2                          []                        --
|    |    └─UpSample: 3-23                    [-1, 62, 64, 64]          130,696
|    |    └─Conv2d: 3-24                      [-1, 62, 64, 64]          7,688
|    |    └─DTNBlock: 3-25                    [-1, 62, 64, 64]          472,112
|    └─ModuleList: 2                          []                        --
|    |    └─UpSample: 3-26                    [-1, 31, 128, 128]        32,674
|    |    └─Conv2d: 3-27                      [-1, 31, 128, 128]        1,922
|    |    └─DTNBlock: 3-28                    [-1, 31, 128, 128]        129,752
├─Conv2d: 1-3                                 [-1, 31, 128, 128]        8,649
===============================================================================================
Total params: 81,088,979
Trainable params: 81,088,979
Non-trainable params: 0
Total mult-adds (M): 569.23
===============================================================================================
Input size (MB): 0.38
Forward/backward pass size (MB): 20.83
Params size (MB): 309.33
Estimated Total Size (MB): 330.53
===============================================================================================
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─DenseNet: 1-1                          [-1, 1]                   --
|    └─Sequential: 2-1                   [-1, 2208, 4, 4]          --
|    |    └─SNConv2d: 3-1                [-1, 96, 64, 64]          174,048
|    |    └─LeakyReLU: 3-2               [-1, 96, 64, 64]          --
|    |    └─MaxPool2d: 3-3               [-1, 96, 32, 32]          --
|    |    └─_DenseBlock: 3-4             [-1, 384, 32, 32]         746,496
|    |    └─_Transition: 3-5             [-1, 192, 16, 16]         73,728
|    |    └─_DenseBlock: 3-6             [-1, 768, 16, 16]         2,045,952
|    |    └─_Transition: 3-7             [-1, 384, 8, 8]           294,912
|    |    └─_DenseBlock: 3-8             [-1, 2112, 8, 8]          11,446,272
|    |    └─_Transition: 3-9             [-1, 1056, 4, 4]          2,230,272
|    |    └─_DenseBlock: 3-10            [-1, 2208, 4, 4]          9,400,320
|    └─LeakyReLU: 2-2                    [-1, 2208, 4, 4]          --
|    └─Sequential: 2-3                   [-1, 1]                   --
|    |    └─SNConv2d: 3-11               [-1, 1, 1, 1]             35,329
|    |    └─AdaptiveAvgPool2d: 3-12      [-1, 1, 1, 1]             --
|    |    └─Flatten: 3-13                [-1, 1]                   --
==========================================================================================
Total params: 26,447,329
Trainable params: 26,447,329
Non-trainable params: 0
Total mult-adds (M): 105.82
==========================================================================================
Input size (MB): 2.31
Forward/backward pass size (MB): 3.00
Params size (MB): 100.89
Estimated Total Size (MB): 106.20
==========================================================================================
pretrained model loaded, iteration:  2280

loading dataset ...
Iteration per epoch: 12160
Validation set samples:  95
MRAE:0.1865498125553131, RMSE: 0.02429857850074768, PSNR:33.9698600769043, SAM: 0.15887467563152313, SID: nan
Saving to /work3/s212645/Spectral_Reconstruction/checkpoint/gan/DTN-SN_Densenet161_Discriminator/
top: 0 saved. 
 Iter[002660], Epoch[000002], learning rate : 0.000399905, Train MRAE: 0.212654591, Test MRAE: 0.186549813, Test RMSE: 0.024298579, Test PSNR: 33.969860077, SAM: 0.158874676, SID: nan 
MRAE:0.3358994424343109, RMSE: 0.03469023481011391, PSNR:30.29844093322754, SAM: 0.24489392340183258, SID: nan
Saving to /work3/s212645/Spectral_Reconstruction/checkpoint/gan/DTN-SN_Densenet161_Discriminator/
top: 1 saved. 
 Iter[003040], Epoch[000003], learning rate : 0.000399617, Train MRAE: 0.205984727, Test MRAE: 0.335899442, Test RMSE: 0.034690235, Test PSNR: 30.298440933, SAM: 0.244893923, SID: nan 
MRAE:0.252521812915802, RMSE: 0.050230223685503006, PSNR:28.911945343017578, SAM: 0.2341039776802063, SID: 0.051843419671058655
Saving to /work3/s212645/Spectral_Reconstruction/checkpoint/gan/DTN-SN_Densenet161_Discriminator/
top: 1 saved. 
 Iter[003420], Epoch[000004], learning rate : 0.000399138, Train MRAE: 0.200729176, Test MRAE: 0.252521813, Test RMSE: 0.050230224, Test PSNR: 28.911945343, SAM: 0.234103978, SID: 0.051843420 
MRAE:0.196695476770401, RMSE: 0.023378707468509674, PSNR:34.71617126464844, SAM: 0.13019588589668274, SID: 0.0148734450340271
Saving to /work3/s212645/Spectral_Reconstruction/checkpoint/gan/DTN-SN_Densenet161_Discriminator/
top: 1 saved. 
 Iter[003800], Epoch[000005], learning rate : 0.000398468, Train MRAE: 0.200385690, Test MRAE: 0.196695477, Test RMSE: 0.023378707, Test PSNR: 34.716171265, SAM: 0.130195886, SID: 0.014873445 
MRAE:0.2064124196767807, RMSE: 0.02466852217912674, PSNR:34.459381103515625, SAM: 0.13390204310417175, SID: 0.016692236065864563
Saving to /work3/s212645/Spectral_Reconstruction/checkpoint/gan/DTN-SN_Densenet161_Discriminator/
 Iter[004180], Epoch[000006], learning rate : 0.000397607, Train MRAE: 0.197705731, Test MRAE: 0.206412420, Test RMSE: 0.024668522, Test PSNR: 34.459381104, SAM: 0.133902043, SID: 0.016692236 
MRAE:0.19597658514976501, RMSE: 0.023589419201016426, PSNR:34.66145324707031, SAM: 0.12825359404087067, SID: 0.01351760234683752
Saving to /work3/s212645/Spectral_Reconstruction/checkpoint/gan/DTN-SN_Densenet161_Discriminator/
top: 1 saved. 
 Iter[004560], Epoch[000007], learning rate : 0.000396557, Train MRAE: 0.199532181, Test MRAE: 0.195976585, Test RMSE: 0.023589419, Test PSNR: 34.661453247, SAM: 0.128253594, SID: 0.013517602 
MRAE:0.22313165664672852, RMSE: 0.035876158624887466, PSNR:31.444726943969727, SAM: 0.122479148209095, SID: 0.01457477267831564
Saving to /work3/s212645/Spectral_Reconstruction/checkpoint/gan/DTN-SN_Densenet161_Discriminator/
 Iter[004940], Epoch[000008], learning rate : 0.000395318, Train MRAE: 0.189491525, Test MRAE: 0.223131657, Test RMSE: 0.035876159, Test PSNR: 31.444726944, SAM: 0.122479148, SID: 0.014574773 
MRAE:0.1645989865064621, RMSE: 0.019601136445999146, PSNR:36.30940628051758, SAM: 0.12189760059118271, SID: 0.01196193229407072
Saving to /work3/s212645/Spectral_Reconstruction/checkpoint/gan/DTN-SN_Densenet161_Discriminator/
top: 0 saved. 
 Iter[005320], Epoch[000009], learning rate : 0.000393891, Train MRAE: 0.184505031, Test MRAE: 0.164598987, Test RMSE: 0.019601136, Test PSNR: 36.309406281, SAM: 0.121897601, SID: 0.011961932 
MRAE:0.18157833814620972, RMSE: 0.02239380218088627, PSNR:35.395751953125, SAM: 0.14958354830741882, SID: 0.016080114990472794
Saving to /work3/s212645/Spectral_Reconstruction/checkpoint/gan/DTN-SN_Densenet161_Discriminator/
top: 1 saved. 
 Iter[005700], Epoch[000010], learning rate : 0.000392279, Train MRAE: 0.180024490, Test MRAE: 0.181578338, Test RMSE: 0.022393802, Test PSNR: 35.395751953, SAM: 0.149583548, SID: 0.016080115 
MRAE:0.28487062454223633, RMSE: 0.02849213406443596, PSNR:32.53828048706055, SAM: 0.1394777148962021, SID: 0.017144573852419853
Saving to /work3/s212645/Spectral_Reconstruction/checkpoint/gan/DTN-SN_Densenet161_Discriminator/
 Iter[006080], Epoch[000011], learning rate : 0.000390481, Train MRAE: 0.179018885, Test MRAE: 0.284870625, Test RMSE: 0.028492134, Test PSNR: 32.538280487, SAM: 0.139477715, SID: 0.017144574 
